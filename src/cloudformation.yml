Parameters:
  EnvironmentParameter:
    Type: String
    Default: dev
    AllowedValues:
      - dev
      - prod

  CertificateArnParameter:
    Type: String
    Default: arn:aws:acm:us-east-1:758881537981:certificate/dc6174a9-ef18-43b3-8b18-c252284d0891

  HostedZoneParameter:
    Type: String
    Default: scotuslink.com.

Mappings:
  URLMap:
    dev:
      URL: dev.scotuslink.com
      Edge: d1tkp7wrgzbag4.cloudfront.net
    prod:
      URL: scotuslink.com
      Edge: d8rqxfm44ppdi.cloudfront.net

Resources:
  # code
  LambdaExecutionRole:
    Type: AWS::IAM::Role
    Properties:
      RoleName: !Join ["-", ["LambdaExecutionRole", !Ref EnvironmentParameter]]
      AssumeRolePolicyDocument:
        Version: 2012-10-17
        Statement:
          - Effect: Allow
            Principal:
              Service:
                - lambda.amazonaws.com
            Action:
              - sts:AssumeRole
      Policies:
        - PolicyName: "CloudwatchLogging"
          PolicyDocument:
            Version: 2012-10-17
            Statement:
              - Effect: Allow
                Action: "logs:CreateLogGroup"
                Resource: "*"
              - Effect: Allow
                Action:
                  - "logs:CreateLogStream"
                  - "logs:PutLogEvents"
                Resource: "*"

  RedirectLambda:
    Type: AWS::Lambda::Function
    Properties:
      FunctionName: !Join ["-", ["redirect-lambda", !Ref EnvironmentParameter]]
      Handler: index.handler
      Role: !GetAtt LambdaExecutionRole.Arn
      Runtime: "nodejs8.10"
      Code:
        ZipFile: !Sub |
            'use strict';

            const LOC_URL_TEMPLATE = "https://cdn.loc.gov/service/ll/usrep/usrep{{volume}}/usrep{{volume}}{{page}}/usrep{{volume}}{{page}}.pdf";
            const LOC_PAGE_URL_TEMPLATE = "https://cdn.loc.gov/service/ll/usrep/usrep{{volume}}/usrep{{volume}}{{page}}/usrep{{volume}}{{page}}.pdf#page={{pdfpage}}";

            const SC_URL_TEMPLATE = "https://www.supremecourt.gov/opinions/boundvolumes/{{volume}}BV.pdf#page={{pdfpage}}";

            const LOC_CUTOFF = 542;

            // http://blog.ryangreen.ca/2016/01/04/how-to-http-redirects-with-api-gateway-and-lambda/
            exports.handler = function(event, context) {
                var volume = pad(event['volume'], 3);
                var page = pad(event['page'], 3);
                var pdfpage = event['pdfpage'];

                var template = volume <= LOC_CUTOFF ?
                    (pdfpage ? LOC_PAGE_URL_TEMPLATE : LOC_URL_TEMPLATE) : SC_URL_TEMPLATE;
                    
                // if pdfpage not provided, then shim in regular page for SC links
                if (!pdfpage) { pdfpage = page; }

                var url = template.replace(/{{volume}}/g, volume).replace(/{{page}}/g, page).replace(/{{pdfpage}}/g, pdfpage);
                
                console.log( "redirecting to " + url);
                context.succeed({
                    location: url
                });
            };

            function pad(n, width) {
                return n.length >= width ? n : new Array(width - n.length + 1).join("0") + n;
            }

  # api
  RedirectAPI:
    Type: AWS::ApiGateway::RestApi
    Properties:
      Name: !Join ["-", ["RedirectAPI", !Ref EnvironmentParameter]]
      FailOnWarnings: true
      Body:
        openapi: 3.0.1
        info:
          title: Redirect API
          description: URL redirect for Supreme Court opinions
          version: 0.0.1
          contact:
            name: Alex Gallichotte
          license:
            name: TBD
            url: TBD
        components:
          schemas:
            Empty:
              type: "object"
        paths:
          /:
            get:
              responses:
                "200":
                  description: "200 response"
                  content:
                    text/html:
                      schema:
                        $ref: "#/components/schemas/Empty"
              x-amazon-apigateway-integration:
                type: "mock"
                responses:
                  default:
                    statusCode: "200"
                    responseTemplates:
                      text/html: !Sub
                        - "<meta charset=UTF-8><meta content=\"width=device-width,initial-scale=1,shrink-to-fit=no\"name=viewport><title>SCOTUS Link</title><link href=https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css rel=stylesheet crossorigin=anonymous integrity=sha384-MCw98/SFnGE8fJT3GXwEOngsV7Zt27NXFoaoApmYm81iuXoPkFOJwJ8ERdknLPMO><style>.form-item{margin:0 0 32px 0}label{margin-bottom:4px}input{font-size:20px!important;padding:24px 0!important;margin:0 auto}footer{text-align:center;font-size:13px;color:#999;margin:32px 0 32px 0}footer a{color:#999;text-decoration:underline}@media (max-width:767.98px){h4{font-size:16px}}#t{padding-bottom:10px}#b{box-shadow:#007bff 0 0 0 0 inset}</style><div class=container style=margin-top:32px;margin-bottom:32px><div class=row><div class=\"col-12 col-md-6 col-sm-8 offset-md-3 offset-sm-2\"><svg viewBox=\"0 0 991.27 368.24\"xmlns=http://www.w3.org/2000/svg><title>scotuslink</title><path d=M295.65,312.75H277.49a2.18,2.18,0,0,0-2.17,2.18v19.86a2.17,2.17,0,0,0,2.17,2.17h18.16a2.18,2.18,0,0,0,2.18-2.17V314.93A2.19,2.19,0,0,0,295.65,312.75Zm-2.17,19.86H279.66V317.1h13.82Z transform=\"translate(-4.37 -15.88)\"style=fill:#e6e6e6 /><path d=M290.81,291.33a2.17,2.17,0,0,0,2.17-2.17c0-5.54,2.54-11.85,2.57-11.91a2.18,2.18,0,0,0-4-1.64c-.12.28-2.88,7.14-2.88,13.55A2.17,2.17,0,0,0,290.81,291.33Z transform=\"translate(-4.37 -15.88)\"style=fill:#e6e6e6 /><path d=M94.41,317.29V286.47a2.17,2.17,0,0,0-2.17-2.17H81.11a2.17,2.17,0,0,0-2.17,2.17v30.82a2.17,2.17,0,0,0,2.17,2.17H92.24A2.17,2.17,0,0,0,94.41,317.29ZM83.29,288.64h6.78v4.22H83.29Zm0,26.47v-17.9h6.78v17.9Z transform=\"translate(-4.37 -15.88)\"style=fill:#e6e6e6 /><path d=M130,317.29V286.47a2.18,2.18,0,0,0-2.18-2.17H116.65a2.17,2.17,0,0,0-2.17,2.17v30.82a2.17,2.17,0,0,0,2.17,2.17h11.12A2.18,2.18,0,0,0,130,317.29Zm-11.13-28.65h6.78v4.22h-6.78Zm0,26.47v-17.9h6.78v17.9Z transform=\"translate(-4.37 -15.88)\"style=fill:#e6e6e6 /><path d=M165.37,317.29V286.47a2.18,2.18,0,0,0-2.18-2.17H152.07a2.18,2.18,0,0,0-2.18,2.17v30.82a2.18,2.18,0,0,0,2.18,2.17h11.12A2.18,2.18,0,0,0,165.37,317.29Zm-11.13-28.65H161v4.22h-6.78Zm0,26.47v-17.9H161v17.9Z transform=\"translate(-4.37 -15.88)\"style=fill:#e6e6e6 /><path d=M200.79,317.29V286.47a2.18,2.18,0,0,0-2.18-2.17H187.49a2.17,2.17,0,0,0-2.17,2.17v30.82a2.17,2.17,0,0,0,2.17,2.17h11.12A2.18,2.18,0,0,0,200.79,317.29Zm-11.13-28.65h6.78v4.22h-6.78Zm0,26.47v-17.9h6.78v17.9Z transform=\"translate(-4.37 -15.88)\"style=fill:#e6e6e6 /><path d=M236,317.54V286.72a2.17,2.17,0,0,0-2.17-2.17H222.66a2.18,2.18,0,0,0-2.18,2.17v30.82a2.18,2.18,0,0,0,2.18,2.17h11.12A2.17,2.17,0,0,0,236,317.54ZM224.83,288.9h6.78v4.21h-6.78Zm0,26.47V297.46h6.78v17.91Z transform=\"translate(-4.37 -15.88)\"style=fill:#e6e6e6 /><path d=M45.81,319.46H56.93a2.17,2.17,0,0,0,2.17-2.17V286.47a2.17,2.17,0,0,0-2.17-2.17H45.81a2.18,2.18,0,0,0-2.18,2.17v30.82A2.18,2.18,0,0,0,45.81,319.46ZM48,315.11v-17.9h6.78v17.9Zm0-26.47h6.78v4.22H48Z transform=\"translate(-4.37 -15.88)\"style=fill:#e6e6e6 /><path d=M92.24,347.7H81.11a2.18,2.18,0,0,0-2.17,2.18v14.26a2.18,2.18,0,0,0,2.17,2.18H92.24a2.18,2.18,0,0,0,2.17-2.18V349.88A2.18,2.18,0,0,0,92.24,347.7Zm-8.95,4.35h6.78v2.44H83.29Zm0,9.92v-3.13h6.78V362Z transform=\"translate(-4.37 -15.88)\"style=fill:#e6e6e6 /><path d=M127.77,347.7H116.65a2.18,2.18,0,0,0-2.17,2.18v14.26a2.18,2.18,0,0,0,2.17,2.18h11.12a2.19,2.19,0,0,0,2.18-2.18V349.88A2.19,2.19,0,0,0,127.77,347.7Zm-9,4.35h6.78v2.44h-6.78Zm0,9.92v-3.13h6.78V362Z transform=\"translate(-4.37 -15.88)\"style=fill:#e6e6e6 /><path d=M163.19,347.7H152.07a2.19,2.19,0,0,0-2.18,2.18v14.26a2.19,2.19,0,0,0,2.18,2.18h11.12a2.19,2.19,0,0,0,2.18-2.18V349.88A2.19,2.19,0,0,0,163.19,347.7Zm-8.95,4.35H161v2.44h-6.78Zm0,9.92v-3.13H161V362Z transform=\"translate(-4.37 -15.88)\"style=fill:#e6e6e6 /><path d=M198.61,347.7H187.49a2.18,2.18,0,0,0-2.17,2.18v14.26a2.18,2.18,0,0,0,2.17,2.18h11.12a2.19,2.19,0,0,0,2.18-2.18V349.88A2.19,2.19,0,0,0,198.61,347.7Zm-9,4.35h6.78v2.44h-6.78Zm0,9.92v-3.13h6.78V362Z transform=\"translate(-4.37 -15.88)\"style=fill:#e6e6e6 /><path d=M233.78,347.85H222.66a2.18,2.18,0,0,0-2.18,2.17v14.27a2.19,2.19,0,0,0,2.18,2.18h11.12a2.18,2.18,0,0,0,2.17-2.18V350A2.17,2.17,0,0,0,233.78,347.85Zm-8.95,4.34h6.78v2.45h-6.78Zm0,9.93V359h6.78v3.13Z transform=\"translate(-4.37 -15.88)\"style=fill:#e6e6e6 /><path d=M56.93,347.7H45.81a2.19,2.19,0,0,0-2.18,2.18v14.26a2.19,2.19,0,0,0,2.18,2.18H56.93a2.18,2.18,0,0,0,2.17-2.18V349.88A2.18,2.18,0,0,0,56.93,347.7Zm-9,4.35h6.78v2.44H48ZM48,362v-3.13h6.78V362Z transform=\"translate(-4.37 -15.88)\"style=fill:#e6e6e6 /><path d=M722.74,312.75H704.58a2.19,2.19,0,0,0-2.18,2.18v19.86a2.18,2.18,0,0,0,2.18,2.17h18.16a2.17,2.17,0,0,0,2.17-2.17V314.93A2.18,2.18,0,0,0,722.74,312.75Zm-2.17,19.86H706.75V317.1h13.82Z transform=\"translate(-4.37 -15.88)\"style=fill:#e6e6e6 /><path d=M705.87,274.42a2.17,2.17,0,0,0-1.19,2.83c0,.06,2.57,6.37,2.57,11.91a2.17,2.17,0,1,0,4.34,0c0-6.41-2.77-13.27-2.88-13.55A2.17,2.17,0,0,0,705.87,274.42Z transform=\"translate(-4.37 -15.88)\"style=fill:#e6e6e6 /><path d=M921.29,317.29V286.47a2.18,2.18,0,0,0-2.18-2.17H908a2.17,2.17,0,0,0-2.17,2.17v30.82a2.17,2.17,0,0,0,2.17,2.17h11.12A2.18,2.18,0,0,0,921.29,317.29Zm-11.13-28.65h6.78v4.22h-6.78Zm0,26.47v-17.9h6.78v17.9Z transform=\"translate(-4.37 -15.88)\"style=fill:#e6e6e6 /><path d=M885.75,317.29V286.47a2.17,2.17,0,0,0-2.17-2.17H872.46a2.18,2.18,0,0,0-2.18,2.17v30.82a2.18,2.18,0,0,0,2.18,2.17h11.12A2.17,2.17,0,0,0,885.75,317.29Zm-11.12-28.65h6.78v4.22h-6.78Zm0,26.47v-17.9h6.78v17.9Z transform=\"translate(-4.37 -15.88)\"style=fill:#e6e6e6 /><path d=M850.33,317.29V286.47a2.17,2.17,0,0,0-2.17-2.17H837a2.17,2.17,0,0,0-2.17,2.17v30.82a2.17,2.17,0,0,0,2.17,2.17h11.13A2.17,2.17,0,0,0,850.33,317.29Zm-11.12-28.65H846v4.22h-6.78Zm0,26.47v-17.9H846v17.9Z transform=\"translate(-4.37 -15.88)\"style=fill:#e6e6e6 /><path d=M814.91,317.29V286.47a2.17,2.17,0,0,0-2.17-2.17H801.62a2.18,2.18,0,0,0-2.18,2.17v30.82a2.18,2.18,0,0,0,2.18,2.17h11.12A2.17,2.17,0,0,0,814.91,317.29Zm-11.12-28.65h6.78v4.22h-6.78Zm0,26.47v-17.9h6.78v17.9Z transform=\"translate(-4.37 -15.88)\"style=fill:#e6e6e6 /><path d=M779.75,317.54V286.72a2.18,2.18,0,0,0-2.18-2.17H766.45a2.18,2.18,0,0,0-2.18,2.17v30.82a2.18,2.18,0,0,0,2.18,2.17h11.12A2.18,2.18,0,0,0,779.75,317.54ZM768.62,288.9h6.78v4.21h-6.78Zm0,26.47V297.46h6.78v17.91Z transform=\"translate(-4.37 -15.88)\"style=fill:#e6e6e6 /><path d=M954.42,284.3H943.3a2.18,2.18,0,0,0-2.18,2.17v30.82a2.18,2.18,0,0,0,2.18,2.17h11.12a2.17,2.17,0,0,0,2.17-2.17V286.47A2.17,2.17,0,0,0,954.42,284.3Zm-8.95,4.34h6.78v4.22h-6.78Zm0,26.47v-17.9h6.78v17.9Z transform=\"translate(-4.37 -15.88)\"style=fill:#e6e6e6 /><path d=M919.11,347.7H908a2.18,2.18,0,0,0-2.17,2.18v14.26a2.18,2.18,0,0,0,2.17,2.18h11.12a2.19,2.19,0,0,0,2.18-2.18V349.88A2.19,2.19,0,0,0,919.11,347.7Zm-9,4.35h6.78v2.44h-6.78Zm0,9.92v-3.13h6.78V362Z transform=\"translate(-4.37 -15.88)\"style=fill:#e6e6e6 /><path d=M883.58,347.7H872.46a2.19,2.19,0,0,0-2.18,2.18v14.26a2.19,2.19,0,0,0,2.18,2.18h11.12a2.18,2.18,0,0,0,2.17-2.18V349.88A2.18,2.18,0,0,0,883.58,347.7Zm-9,4.35h6.78v2.44h-6.78Zm0,9.92v-3.13h6.78V362Z transform=\"translate(-4.37 -15.88)\"style=fill:#e6e6e6 /><path d=M848.16,347.7H837a2.18,2.18,0,0,0-2.17,2.18v14.26a2.18,2.18,0,0,0,2.17,2.18h11.13a2.18,2.18,0,0,0,2.17-2.18V349.88A2.18,2.18,0,0,0,848.16,347.7Zm-8.95,4.35H846v2.44h-6.78Zm0,9.92v-3.13H846V362Z transform=\"translate(-4.37 -15.88)\"style=fill:#e6e6e6 /><path d=M812.74,347.7H801.62a2.19,2.19,0,0,0-2.18,2.18v14.26a2.19,2.19,0,0,0,2.18,2.18h11.12a2.18,2.18,0,0,0,2.17-2.18V349.88A2.18,2.18,0,0,0,812.74,347.7Zm-9,4.35h6.78v2.44h-6.78Zm0,9.92v-3.13h6.78V362Z transform=\"translate(-4.37 -15.88)\"style=fill:#e6e6e6 /><path d=M777.57,347.85H766.45a2.18,2.18,0,0,0-2.18,2.17v14.27a2.19,2.19,0,0,0,2.18,2.18h11.12a2.19,2.19,0,0,0,2.18-2.18V350A2.18,2.18,0,0,0,777.57,347.85Zm-9,4.34h6.78v2.45h-6.78Zm0,9.93V359h6.78v3.13Z transform=\"translate(-4.37 -15.88)\"style=fill:#e6e6e6 /><path d=M954.42,347.7H943.3a2.19,2.19,0,0,0-2.18,2.18v14.26a2.19,2.19,0,0,0,2.18,2.18h11.12a2.18,2.18,0,0,0,2.17-2.18V349.88A2.18,2.18,0,0,0,954.42,347.7Zm-8.95,4.35h6.78v2.44h-6.78Zm0,9.92v-3.13h6.78V362Z transform=\"translate(-4.37 -15.88)\"style=fill:#e6e6e6 /><path d=M993.46,379.77h-14.7V325.61a2.18,2.18,0,0,0-2.18-2.17h-1.91V250h1.91a2.19,2.19,0,0,0,2.18-2.18v-8.27h6.45a2.18,2.18,0,0,0,2.18-2.17v-8.18a2.18,2.18,0,0,0-2.18-2.17h-6.45V221.5a2.19,2.19,0,0,0-2.18-2.18H961.3l-67.5-10-.32,0H682.43l-.16,0V153.28a2.17,2.17,0,0,0,2.15-2.44c0-.1-1.19-9.92,3.82-15,0,0,0,0,0,0a2,2,0,0,0,.32-.44l.06-.11a2.47,2.47,0,0,0,.19-.54v0a2.33,2.33,0,0,0,0-.37V88.63h10.95A2.17,2.17,0,0,0,702,86.46V80.27s0-.07,0-.1a1.94,1.94,0,0,0,0-.24c0-.06,0-.13,0-.19a1.72,1.72,0,0,0-.07-.21,1.54,1.54,0,0,0-.08-.19l-.09-.18-.12-.18-.13-.16-.15-.15-.16-.13-.18-.12a.56.56,0,0,0-.17-.09l-.22-.1-.09,0L499.48,16a2.18,2.18,0,0,0-1.29,0L300.45,78.2s-.05,0-.08,0l-.23.1-.16.09-.19.13-.15.12c-.06,0-.11.11-.16.16l-.12.15-.12.19a.91.91,0,0,0-.09.17,1.21,1.21,0,0,0-.09.2l-.06.2c0,.06,0,.13,0,.2a1.79,1.79,0,0,0,0,.23s0,.06,0,.1v6.19a2.17,2.17,0,0,0,2.17,2.17h8.17v45.68a2.33,2.33,0,0,0,0,.37v0a2.47,2.47,0,0,0,.19.54l.06.11a2,2,0,0,0,.32.44s0,0,0,0c5,5.07,3.83,14.91,3.82,15a2.14,2.14,0,0,0,.52,1.7,2.19,2.19,0,0,0,1.63.74h.78v56.05H106.74l-.31,0-67.5,10H23.64a2.18,2.18,0,0,0-2.17,2.18V227H15a2.18,2.18,0,0,0-2.18,2.17v8.18A2.18,2.18,0,0,0,15,239.56h6.45v8.27A2.18,2.18,0,0,0,23.64,250h1.92v73.43H23.64a2.17,2.17,0,0,0-2.17,2.17v54.16H6.54a2.18,2.18,0,0,0,0,4.35H993.46a2.18,2.18,0,0,0,0-4.35ZM686.92,344.2H308.42v-2.77H691.81v2.77Zm-2.17,21.34H315.48v-2.77H684.75Zm-369.27,4.35h369v2.77h-369Zm369-11.46h-369v-2.77h369ZM315.48,377H684.75v2.77H315.48Zm369.27-25.69H315.48v-2.76H684.75ZM269.07,344.2V307h35V344.2ZM25.82,334.32h238.9v2.77H25.82Zm0-6.53H41.45V330H25.82ZM61,250v21.53H41.26V250Zm11.35,0v2.28h-7V250Zm24.07,0v21.53H76.68V250Zm11.35,0v2.28h-7V250Zm24.07,0v21.53H112.1V250Zm11.35,0v2.28h-7V250Zm24.07,0v21.53H147.52V250Zm11.35,0v2.28h-7V250Zm24.07,0v21.53H182.94V250ZM214,250v2.28h-7V250Zm24.07,0v21.53H218.36V250Zm11.35,0v2.28h-7V250Zm24.07,0v11.93a7.24,7.24,0,0,0-1.81-1.88,2.58,2.58,0,0,0-2.75-.06c-1.6,1-1.42,2.83-1,6.8.15,1.43.31,3,.41,4.74H253.78V250Zm11.35,0v2.28h-7V250Zm31.79,0v59.68h-.44a2.17,2.17,0,0,0-2.17,2.17v4h-.72a2.18,2.18,0,0,0-2.18,2.17v4.87h-2.71V307h2.07a2.18,2.18,0,0,0,2.17-2.18V298.4a2.18,2.18,0,0,0-2.17-2.18h-7.06a36.13,36.13,0,0,0-.43-5.73,31.39,31.39,0,0,1-.33-3.45,16.05,16.05,0,0,1,.75-3.55c.75-2.7,1.69-6.06,1-9.57-.9-4.81-8-11.12-10.37-13.13-.56-3.83-2.31-6.67-4.88-7.89V250Zm26.2-114.18v0a2,2,0,0,0,.33-.44l.06-.11a2.45,2.45,0,0,0,.18-.54.08.08,0,0,1,0,0,2.31,2.31,0,0,0,0-.37v-6.46h13.86v6.46a2.31,2.31,0,0,0,0,.37.08.08,0,0,1,0,0,2.45,2.45,0,0,0,.18.54l.06.11a2,2,0,0,0,.33.44v0c3.65,3.71,4,10,3.93,13.11h-23C338.84,145.8,339.2,139.54,342.84,135.83Zm-29.22-3.7v-4.28h25.5v4.28Zm364.54-43.5v2.48H320V88.63Zm2.17,6.83h4.18v14.42H313.62V95.46H680.33ZM659,132.13v-4.28h25.5v4.28Zm18.92,21.15V309.69H666.38V153.28ZM746.45,250v21.53H731.89c.1-1.71.26-3.32.41-4.74.41-4,.59-5.79-1-6.8a2.58,2.58,0,0,0-2.75.06,7.24,7.24,0,0,0-1.81,1.88V250Zm11.35,0v2.28h-7V250Zm24.07,0v21.53H762.15V250Zm11.35,0v2.28h-7V250Zm24.07,0v21.53H797.57V250Zm11.35,0v2.28h-7V250Zm24.07,0v21.53H833V250Zm11.35,0v2.28h-7V250Zm24.07,0v21.53H868.41V250Zm11.35,0v2.28h-7V250Zm24.07,0v21.53H903.83V250Zm11.35,0v2.28h-7V250ZM959,250v21.53H939.25V250Zm15.44,77.78V330H958.78v-2.18h15.63Zm-17.81-4.35a2.17,2.17,0,0,0-2.17,2.17V330H943.34v-4.36a2.17,2.17,0,0,0-2.18-2.17h-1.91V275.89H959v47.55ZM907.92,330v-4.36a2.18,2.18,0,0,0-2.18-2.17h-1.91V275.89h19.72v47.55h-2.37a2.17,2.17,0,0,0-2.17,2.17V330Zm-35.42,0v-4.36a2.18,2.18,0,0,0-2.18-2.17h-1.91V275.89h19.72v47.55h-2.37a2.17,2.17,0,0,0-2.17,2.17V330Zm-35.42,0v-4.36a2.18,2.18,0,0,0-2.18-2.17H833V275.89h19.72v47.55h-2.37a2.17,2.17,0,0,0-2.17,2.17V330Zm-35.42,0v-4.36a2.18,2.18,0,0,0-2.18-2.17h-1.91V275.89h19.72v47.55h-2.37a2.17,2.17,0,0,0-2.17,2.17V330Zm-35.42,0v-4.36a2.18,2.18,0,0,0-2.18-2.17h-1.91V275.89h19.72v47.55H779.5a2.17,2.17,0,0,0-2.17,2.17V330ZM750.8,273.72V256.63h7v66.81h-7Zm-2.18,54.07h13.27V330H746.26v-2.18Zm44.6-54.07v49.72h-7V256.63h7Zm-11.54,54.07h15.63V330H781.68Zm47-54.07v49.72h-7V256.63h7ZM817.1,327.79h15.63V330H817.1Zm47-54.07v49.72h-7V256.63h7Zm-11.54,54.07h15.63V330H852.52Zm47-54.07v49.72h-7V256.63h7Zm-11.54,54.07h15.63V330H887.94Zm47-54.07v49.72h-7V256.63h7Zm-11.54,54.07H939V330H923.36Zm-188-25.11H691.91v-2.11H735.4ZM264.72,330h-6.4v-4.36a2.17,2.17,0,0,0-2.17-2.17h-2.37V275.89h14.41c-.05.36-.11.7-.16,1a11.44,11.44,0,0,0,.45,6.61c.84,2.35.56,8.39.11,12.69h-5.93a2.19,2.19,0,0,0-2.18,2.18v6.45a2.19,2.19,0,0,0,2.18,2.18h2.06Zm-41.82,0v-4.36a2.17,2.17,0,0,0-2.17-2.17h-2.37V275.89h19.72v47.55h-1.91a2.17,2.17,0,0,0-2.18,2.17V330Zm-35.42,0v-4.36a2.17,2.17,0,0,0-2.17-2.17h-2.37V275.89h19.72v47.55h-1.91a2.18,2.18,0,0,0-2.18,2.17V330Zm-35.42,0v-4.36a2.17,2.17,0,0,0-2.17-2.17h-2.37V275.89h19.72v47.55h-1.91a2.18,2.18,0,0,0-2.18,2.17V330Zm-35.42,0v-4.36a2.17,2.17,0,0,0-2.17-2.17H112.1V275.89h19.72v47.55H129.9a2.17,2.17,0,0,0-2.17,2.17V330Zm-35.42,0v-4.36A2.18,2.18,0,0,0,79,323.44H76.68V275.89H96.4v47.55H94.49a2.17,2.17,0,0,0-2.18,2.17V330Zm-15.9-56.25V256.63h7v66.81h-7Zm-4.08,54.07H76.87V330H61.24Zm46.51-54.07v49.72h-7V256.63h7ZM96.66,327.79h15.63V330H96.66Zm46.51-54.07v49.72h-7V256.63h7Zm-11.09,54.07h15.63V330H132.08Zm46.51-54.07v49.72h-7V256.63h7ZM167.5,327.79h15.63V330H167.5ZM214,273.72v49.72h-7V256.63h7Zm-11.09,54.07h15.63V330H202.92Zm46.51-54.07v49.72h-7V256.63h7Zm-11.09,54.07H254V330H238.34Zm34.23-45.72a7.34,7.34,0,0,1-.25-4.46,25.58,25.58,0,0,0,.38-6c-.07-1.24-.16-2.4-.27-3.5l.71,1.13c2.3,3.65,2.72,4.31,3.82,4.59,1.74.43,2.46-.6,5.17-4.42a41,41,0,0,1,3.32-4.35c2.22-1.33,1.19-3.86.58-5.37-.25-.61-.92-2.23-.63-2.69a1.87,1.87,0,0,1,1.92-.22c1,.48,2.25,2.13,2.54,5.3a2.16,2.16,0,0,0,.8,1.49c3.38,2.74,9,8.17,9.52,11.12.47,2.51-.28,5.22-.95,7.61a18.83,18.83,0,0,0-.91,4.71,33.73,33.73,0,0,0,.37,4,31.77,31.77,0,0,1,.39,5.17H283.86a184,184,0,0,1,1.24-19.53,2.18,2.18,0,0,0-4.32-.52,184.55,184.55,0,0,0-1.26,20.05H273C273.34,292.46,273.81,285.52,272.57,282.07ZM282,261.36l.3.75a42.31,42.31,0,0,0-3.72,4.82l-.74,1V256.63H281A10.14,10.14,0,0,0,282,261.36Zm-17.17,41.32v-2.11h43.48v2.11H264.83Zm50.65,17.48H338v2.7H315.48ZM362.07,314v1.78h-.72a2.17,2.17,0,0,0-2.17,2.17v4.87H342.39V318a2.18,2.18,0,0,0-2.18-2.17h-.61V314ZM336.88,153.28h27.81v5.34H336.88Zm26.82-16.8h8.54v3.12a2.18,2.18,0,1,0,4.35,0v-3.12h8.54a26.61,26.61,0,0,0-2.52,12.46H366.22C366.28,146,366,140.87,363.7,136.48Zm-22.41-13H313.62v-2.92H684.51v2.92H341.29Zm-27.67-9.28H684.51v2H313.62ZM639.73,322.86V318a2.17,2.17,0,0,0-2.17-2.17H637V314h22.47v1.78h-.72a2.17,2.17,0,0,0-2.17,2.17v4.87Zm-49.28,0V318a2.17,2.17,0,0,0-2.17-2.17h-.61V314h23.71v1.78h-.72a2.18,2.18,0,0,0-2.18,2.17v4.87Zm-48.05,0V318a2.17,2.17,0,0,0-2.17-2.17h-.61V314h22.47v1.78h-.72A2.17,2.17,0,0,0,559.2,318v4.87Zm-41.16,0V277.71h15.42v32h-.44a2.17,2.17,0,0,0-2.17,2.17v4h-.72a2.18,2.18,0,0,0-2.18,2.17v4.87Zm-13.48,0V318a2.17,2.17,0,0,0-2.17-2.17H485v-4a2.17,2.17,0,0,0-2.17-2.17h-.55v-32h14.63v45.15Zm-48,0V318a2.18,2.18,0,0,0-2.18-2.17h-.61V314h22.48v1.78h-.73a2.17,2.17,0,0,0-2.17,2.17v4.87Zm-49.29,0V318a2.17,2.17,0,0,0-2.17-2.17h-.61V314h23.71v1.78h-.72a2.18,2.18,0,0,0-2.18,2.17v4.87Zm-26.91-2.7h22.56v2.7H363.52Zm27.37-184.33a0,0,0,0,1,0,0,2,2,0,0,0,.32-.44l.06-.11a2,2,0,0,0,.19-.54v0a2.33,2.33,0,0,0,0-.37v-6.46H406.6v6.46a2.33,2.33,0,0,0,0,.37v0a2.47,2.47,0,0,0,.19.54l.06.11a2,2,0,0,0,.32.44s0,0,0,0c3.65,3.71,4,10,3.93,13.11H387C386.87,145.81,387.22,139.56,390.89,135.83Zm63.76-8v6.46a2.31,2.31,0,0,0,0,.37.06.06,0,0,1,0,0,2.45,2.45,0,0,0,.18.54l.06.11a2.41,2.41,0,0,0,.33.44v0c3.65,3.71,4,10,3.93,13.11h-23c-.07-3.14.28-9.4,3.93-13.11l0,0a2.36,2.36,0,0,0,.32-.44l.06-.11a2.45,2.45,0,0,0,.18-.54.08.08,0,0,1,0,0,2.31,2.31,0,0,0,0-.37v-6.46Zm54.64,0v6.46a2.33,2.33,0,0,0,0,.37v0a2.47,2.47,0,0,0,.19.54l.06.11a2,2,0,0,0,.32.44s0,0,0,0c3.65,3.71,4,10,3.93,13.11H484.28c-.08-3.13.27-9.38,3.94-13.11,0,0,0,0,0,0a2,2,0,0,0,.32-.44l.06-.11a2,2,0,0,0,.19-.54v0a2.33,2.33,0,0,0,0-.37v-6.46Zm48.05,0v6.46a2.31,2.31,0,0,0,0,.37.06.06,0,0,1,0,0,2,2,0,0,0,.18.54l.06.11a2.36,2.36,0,0,0,.32.44l0,0c3.64,3.71,4,10,3.93,13.11h-23c-.08-3.13.27-9.38,3.93-13.11l0,0a2.36,2.36,0,0,0,.32-.44l.06-.11a2,2,0,0,0,.18-.54s0,0,0,0a2.31,2.31,0,0,0,0-.37v-6.46Zm49.28,0v6.46a2.33,2.33,0,0,0,0,.37v0a2.47,2.47,0,0,0,.19.54l.06.11a2,2,0,0,0,.32.44s0,0,0,0c3.65,3.71,4,10,3.93,13.11H587c-.07-3.14.28-9.4,3.93-13.11,0,0,0,0,0,0a2,2,0,0,0,.32-.44l.06-.11a2.47,2.47,0,0,0,.19-.54v0a2.33,2.33,0,0,0,0-.37v-6.46Zm23.26,25.43V309.69H618.34V153.28ZM662,298.11H634.23v-120H662Zm-29.43,17.71H615.72V314h16.89Zm-49.29,0H566.44V314h16.88Zm-48,0H518.39V314h16.89Zm-53-42.46v-3.22h34.4v3.22Zm-49.67,42.46H415.7V314h16.89ZM384.93,153.28h29v5.34h-29ZM413,136.48h8.54v3.12a2.18,2.18,0,1,0,4.35,0v-3.12h8.54c-2.29,4.39-2.58,9.5-2.52,12.46H415.5A26.61,26.61,0,0,0,413,136.48Zm48,0h8.54v3.12a2.18,2.18,0,1,0,4.35,0v-3.12h8.54a26.61,26.61,0,0,0-2.52,12.46H463.55C463.61,146,463.32,140.87,461,136.48Zm54.64,0h8.54v3.12a2.18,2.18,0,1,0,4.35,0v-3.12h8.54c-2.29,4.39-2.58,9.5-2.52,12.46H518.19A26.61,26.61,0,0,0,515.67,136.48Zm48.05,0h8.54v3.12a2.17,2.17,0,1,0,4.34,0v-3.12h8.55a26.61,26.61,0,0,0-2.52,12.46H566.24C566.3,146,566,140.87,563.72,136.48Zm5.33,173.21V153.28H580.6V309.69ZM536.9,163h27.58v10.79H536.9Zm0,15.14h27.81v120H536.9Zm48,95.81h5V287h-5Zm0,17.41h7.22a2.17,2.17,0,0,0,2.17-2.17V271.75a2.17,2.17,0,0,0-2.17-2.17h-7.22V178.11h29v120h-29Zm28.32-117.57H585.68V163h27.58Zm-49.33-20.48h.55v5.34H536.9v-5.34ZM482.26,259.74V239.56h9.82v20.18ZM516.66,214h-34.4v-2.61h34.4Zm0,6.06h-34.4v-1.71h34.4Zm0,15.13h-34.4V224.43h34.4Zm-34.4-28.15V178.11h34.4v28.95Zm14.16,32.5h6.07v20.18h-6.07Zm10.42,0h9.82v20.18h-9.82Zm9.82-65.8h-34.4V163h34.4Zm-34.4,90.32h34.4v1.71h-34.4Zm33.62-110.8h.78v5.34h-34.4v-5.34ZM418.32,309.69V153.28h11.55V309.69ZM414,287h-5V273.92h5Zm-29-124h29v10.79h-29ZM462,173.76H434.21V163H462Zm-27.81,4.35H462v120H434.21Zm27-24.83H462v5.34H434.21v-5.34Zm-76.31,24.83h29v91.47h-7.21a2.18,2.18,0,0,0-2.18,2.17v17.41a2.18,2.18,0,0,0,2.18,2.17H414v6.78h-29Zm49.83,131.58h-.55v-7.24H462v7.24H434.76Zm29,4.35h16.88v1.78H463.75Zm2.61-4.35V153.28h11.55V309.69ZM521,275.53V153.28h11.54V309.69H521Zm16.44,34.16h-.55v-7.24h27.81v7.24H537.45Zm48,0h-.56v-7.24h29v7.24H585.5ZM614,158.62h-29v-5.34h29Zm-26.81-26.49h-25.5v-4.28h25.5Zm-48,0h-25.5v-4.28h25.5Zm-54.65,0H459v-4.28h25.5Zm-48,0H411v-4.28h25.5ZM384.93,302.45h29v7.24h-29Zm27.88,17.71h22.56v2.7H412.81Zm48,0h22.57v2.7H460.85Zm54.65,0h22.56v2.7H515.5Zm48,0H586.1v2.7H563.54Zm49.29,0h22.56v2.7H612.83Zm48,0h22.56v2.7H660.87ZM680.65,314v1.78H663.77V314h16.88Zm-19-4.35H634.23v-7.24H662v7.24Zm.32-135.93H634.34V163h27.58Zm-30-24.82H615.52A26.61,26.61,0,0,0,613,136.48h8.54v3.12a2.18,2.18,0,1,0,4.35,0v-3.12h8.54C632.14,140.87,631.85,146,631.91,148.94Zm4.56-16.81H611v-4.28h25.5Zm-249.31-4.28v4.28h-25.5v-4.28ZM336.88,163h27.81v10.79H336.88Zm0,15.14h27.81v120H336.88ZM369,300.28v-147h11.55V309.69H369ZM366.86,314H383.3v1.78H366.42V314ZM313.31,327.2h378.5V330H308.42V327.2Zm-4.89,7.12H691.81v2.77H308.42Zm412.29-38.1a184.55,184.55,0,0,0-1.26-20.05,2.18,2.18,0,1,0-4.32.52,183.72,183.72,0,0,1,1.24,19.53H701.15a31.77,31.77,0,0,1,.39-5.17,33.54,33.54,0,0,0,.36-4,18.79,18.79,0,0,0-.9-4.71c-.67-2.39-1.42-5.1-1-7.61.55-3,6.13-8.38,9.52-11.12a2.16,2.16,0,0,0,.8-1.49c.29-3.17,1.5-4.82,2.54-5.3a1.91,1.91,0,0,1,2,.29c.19.39-.47,2-.72,2.62-.61,1.51-1.64,4,.51,5.33a38.74,38.74,0,0,1,3.39,4.39c2.71,3.82,3.43,4.85,5.17,4.42,1.1-.28,1.52-.94,3.82-4.6l.71-1.12c-.11,1.09-.2,2.26-.27,3.5a25.58,25.58,0,0,0,.38,6,7.34,7.34,0,0,1-.25,4.46c-1.24,3.45-.77,10.39-.39,14.15Zm1.67-30.68V268l-.74-1a42.56,42.56,0,0,0-3.71-4.82c.09-.25.21-.53.3-.75a10.14,10.14,0,0,0,1-4.73h3.15Zm0-13.25h-7V250h7ZM711,251.15v1.75c-2.58,1.22-4.32,4.06-4.88,7.89-2.39,2-9.47,8.32-10.37,13.13-.66,3.51.28,6.87,1,9.57a16.65,16.65,0,0,1,.75,3.55,31.61,31.61,0,0,1-.33,3.45,35,35,0,0,0-.43,5.73h-7.06a2.18,2.18,0,0,0-2.17,2.18v6.45a2.18,2.18,0,0,0,2.17,2.18h2.07v15.83h-4V318a2.17,2.17,0,0,0-2.17-2.17H685v-4a2.17,2.17,0,0,0-2.17-2.17h-.56V250l.16,0H711Zm-49-92.53H634.23v-5.34H662Zm-2.82-9.68h-23c-.07-3.14.29-9.4,3.93-13.11v0a2,2,0,0,0,.33-.44l.06-.11a2.45,2.45,0,0,0,.18-.54v0a1.55,1.55,0,0,0,0-.37v-6.46h13.86v6.46a2.31,2.31,0,0,0,0,.37.06.06,0,0,1,0,0,2.45,2.45,0,0,0,.18.54l.06.11a2.36,2.36,0,0,0,.32.44l0,0C658.93,139.54,659.29,145.8,659.22,148.94ZM336.88,302.45h27.81v7.24H336.88ZM334.71,314h.55v1.78H318.37V314h16.34ZM41.26,275.89H61v47.55H59.06a2.17,2.17,0,0,0-2.17,2.17V330H45.8v-4.36a2.17,2.17,0,0,0-2.17-2.17H41.26Zm654.89,63.37V307h35V344.2h-35ZM735.51,307h2.06a2.19,2.19,0,0,0,2.18-2.18V298.4a2.19,2.19,0,0,0-2.18-2.18h-5.94c-.45-4.3-.72-10.33.12-12.69a11.44,11.44,0,0,0,.45-6.61c-.05-.33-.11-.67-.16-1h14.41v47.55h-2.37a2.17,2.17,0,0,0-2.17,2.17V330h-6.4Zm0,27.29h238.9v2.77H735.51Zm227.81-10.88V256.63h7v66.81Zm7-71.15h-7V250h7Zm4.09-6.63H684.6v-6.1H974.41ZM983,235.21H684.6v-3.82H983ZM974.41,227H684.6v-3.37H974.41Zm-292-13.36H893.32l38.24,5.64H682.27v-5.66ZM680,148.94H663.57c.06-3-.23-8.07-2.52-12.46h8.54v3.12a2.17,2.17,0,1,0,4.34,0v-3.12h8.55A26.61,26.61,0,0,0,680,148.94Zm4.55-57.83h-2V88.63h2ZM498.84,20.33,685.43,78.09h-16l-169.75-53a2.18,2.18,0,0,0-1.29,0l-169.59,53H315.25Zm142,57.76-141.14-43a2.12,2.12,0,0,0-1.27,0l-141.14,43h-13.9L499.06,29.41,654.88,78.09Zm-14.9,0H372.19L499.06,39.4ZM303.28,82.44H697.63v1.85H303.28Zm12.35,6.19v2.48h-2V88.63Zm0,47.85h8.54v3.12a2.18,2.18,0,1,0,4.35,0v-3.12h8.54c-2.29,4.39-2.58,9.5-2.52,12.46H318.17A26.61,26.61,0,0,0,315.65,136.48Zm16.88,16.8V309.69H321V153.28ZM106.9,213.68H316.64v5.64h-248Zm-81.08,10H315.63V227H25.82Zm-8.63,7.72H315.63v3.82H17.19Zm298.44,8.17v6.1H25.82v-6.1ZM36.91,250v2.28h-7V250Zm-7,6.62h7v66.81h-7Zm-4.08,84.8h238.9v2.77h-3.28a2.17,2.17,0,0,0-2.17,2.17v33.4H25.82Zm237.82,38.34h0V348.55h47.51v31.22Zm473,0h-47.5V348.55h47.52v31.22Zm4.37,0v-33.4a2.18,2.18,0,0,0-2.18-2.17h-3.27v-2.77h238.9v38.34Z transform=\"translate(-4.37 -15.88)\"style=fill:#e6e6e6 /><path d=M35.26,180.84c7.36,4.25,15.69,6,19.78,6,3.43,0,5.88-1.23,5.88-4.25,0-4.25-4.74-4.25-12.26-6.86-9-3.11-15.19-7.52-15.19-17.08,0-11.52,8.9-18.79,22.14-18.79a46.6,46.6,0,0,1,19.28,4.33v15.53c-7.11-4-15-5.89-19.12-5.89-3.1,0-5.23,1-5.23,3.6,0,3.84,4.58,3.84,11.77,6.37C71.54,167.12,78,171.69,78,181.66c0,11.93-9.39,19.2-23.12,19.2a48.27,48.27,0,0,1-19.61-4.25Z transform=\"translate(-4.37 -15.88)\"/><path d=M109.85,196.61a18.08,18.08,0,0,1-11.43,4.25,15.52,15.52,0,0,1-10.3-3.68c-2.86-2.61-4.16-6.37-4.16-12.42v-25h16.17v22.87c0,2.12.41,3.11,1.15,3.84a4.1,4.1,0,0,0,3,1.14,8.25,8.25,0,0,0,5.39-2.28V159.77h16.18V200H110v-3.27Z transform=\"translate(-4.37 -15.88)\"/><path d=M150.54,217.93H134.36V159.77h15.85v1.71l.17.08a16.39,16.39,0,0,1,9-2.69c10,0,19,8,19,20.58,0,12.83-9.24,21.41-21.16,21.41a15.06,15.06,0,0,1-6.46-1.23l-.16.08Zm3.68-29.57c5.47,0,7.76-3.68,7.76-8.25s-2.45-8.34-7.19-8.34a8.75,8.75,0,0,0-4.25,1.15v14.79A10,10,0,0,0,154.22,188.36Z transform=\"translate(-4.37 -15.88)\"/><path d=M184.61,159.77h15.85v4.33l.16.08a13.61,13.61,0,0,1,13.64-4.82v14.87a21.18,21.18,0,0,0-4.41-.49,12.35,12.35,0,0,0-9.07,3.34V200H184.61Z transform=\"translate(-4.37 -15.88)\"/><path d=M257.24,197.75a39.83,39.83,0,0,1-15.69,3.11c-14.21,0-23.94-7.84-23.94-20.59,0-13.23,10.38-21.4,21.82-21.4,9.88,0,20.09,6.12,20.09,20.58a33,33,0,0,1-.24,4.09H234c1.56,4.25,5.4,5.72,9.73,5.72a29.49,29.49,0,0,0,13.48-3.76ZM245,175.21c-.73-3.68-3.27-4.91-5.64-4.91-2.85,0-4.82,1.8-5.55,4.91Z transform=\"translate(-4.37 -15.88)\"/><path d=M317,177.17a5.35,5.35,0,0,0-1.15-3.84,4.17,4.17,0,0,0-3.1-1.15,8,8,0,0,0-4.9,1.88V200H291.63V177.17a5.4,5.4,0,0,0-1.14-3.84,4.19,4.19,0,0,0-3.11-1.15,7.49,7.49,0,0,0-4.9,2V200H266.31V159.77h15.84v2.94l.17.08a19.24,19.24,0,0,1,11.27-3.92c4.09,0,8.91,1.55,11.44,5.14,4.9-3.75,9.31-5.14,13.89-5.14a15,15,0,0,1,10.37,3.84c2.53,2.53,3.84,6.12,3.84,12V200H317Z transform=\"translate(-4.37 -15.88)\"/><path d=M378.8,197.75a39.78,39.78,0,0,1-15.68,3.11c-14.22,0-23.94-7.84-23.94-20.59,0-13.23,10.37-21.4,21.81-21.4,9.89,0,20.1,6.12,20.1,20.58a31.09,31.09,0,0,1-.25,4.09H355.6c1.55,4.25,5.39,5.72,9.72,5.72a29.46,29.46,0,0,0,13.48-3.76Zm-12.25-22.54c-.74-3.68-3.27-4.91-5.64-4.91-2.86,0-4.82,1.8-5.56,4.91Z transform=\"translate(-4.37 -15.88)\"/><path d=M455.76,197.35a41.66,41.66,0,0,1-17.16,3.51c-19.85,0-33.16-13.24-33.16-30.39,0-17.49,13.8-30.56,33.16-30.56a40.58,40.58,0,0,1,16.34,3.35v16.51a31.57,31.57,0,0,0-16-4.91c-10,0-16.67,6.46-16.67,15.44,0,8.58,6.21,15.61,17,15.61a31.6,31.6,0,0,0,16.5-5.15Z transform=\"translate(-4.37 -15.88)\"/><path d=M483.7,158.87c13.48,0,23.2,9.15,23.2,21s-9.72,21-23.2,21-23.2-9.15-23.2-21S470.22,158.87,483.7,158.87Zm0,28.51a7.52,7.52,0,1,0-7.19-7.52A7.18,7.18,0,0,0,483.7,187.38Z transform=\"translate(-4.37 -15.88)\"/><path d=M538.85,196.61a18.09,18.09,0,0,1-11.44,4.25,15.47,15.47,0,0,1-10.29-3.68c-2.86-2.61-4.17-6.37-4.17-12.42v-25h16.17v22.87c0,2.12.41,3.11,1.15,3.84a4.11,4.11,0,0,0,3,1.14,8.25,8.25,0,0,0,5.39-2.28V159.77h16.18V200H539v-3.27Z transform=\"translate(-4.37 -15.88)\"/><path d=M563.36,159.77h15.85v4.33l.16.08A13.61,13.61,0,0,1,593,159.36v14.87a21.18,21.18,0,0,0-4.41-.49,12.35,12.35,0,0,0-9.07,3.34V200H563.36Z transform=\"translate(-4.37 -15.88)\"/><path d=M628,198.9a26.15,26.15,0,0,1-10.05,2c-5,0-9.23-1.55-11.85-4.17-2.28-2.29-3.92-5.72-3.92-12.66V172.51h-6V159.77h6V149.72l16.18-2.78v12.83H628v12.74h-9.64v10.38c0,3.18,1,5,4,5a17.28,17.28,0,0,0,5.64-1.31Z transform=\"translate(-4.37 -15.88)\"/><path d=M683.94,139.91c17.81,0,31.62,13.4,31.62,30.48s-13.81,30.47-31.62,30.47-31.62-13.4-31.62-30.47S666.13,139.91,683.94,139.91Zm0,45.84c8.33,0,14.79-6.79,14.79-15.36S692.27,155,683.94,155s-14.79,6.78-14.79,15.36S675.61,185.75,683.94,185.75Z transform=\"translate(-4.37 -15.88)\"/><path d=M738.6,217.93H722.42V159.77h15.85v1.71l.16.08a16.43,16.43,0,0,1,9-2.69c10.05,0,19,8,19,20.58,0,12.83-9.23,21.41-21.16,21.41a15,15,0,0,1-6.45-1.23l-.16.08Zm3.67-29.57c5.48,0,7.76-3.68,7.76-8.25s-2.45-8.34-7.19-8.34a8.74,8.74,0,0,0-4.24,1.15v14.79A10,10,0,0,0,742.27,188.36Z transform=\"translate(-4.37 -15.88)\"/><path d=M780.83,138a8.42,8.42,0,1,1-8.49,8.42A8.43,8.43,0,0,1,780.83,138Zm-8.08,21.82h16.17V200H772.75Z transform=\"translate(-4.37 -15.88)\"/><path d=M797.58,159.77h15.85v3.1l.16.08a19.74,19.74,0,0,1,11.69-4.08,14.89,14.89,0,0,1,10.29,3.84c2.61,2.53,3.92,6.12,3.92,12V200H823.31V177.17a5.35,5.35,0,0,0-1.14-3.84,4.18,4.18,0,0,0-3.1-1.15,8.07,8.07,0,0,0-5.31,2.13V200H797.58Z transform=\"translate(-4.37 -15.88)\"/><path d=M856.08,138a8.42,8.42,0,1,1-8.5,8.42A8.42,8.42,0,0,1,856.08,138ZM848,159.77h16.17V200H848Z transform=\"translate(-4.37 -15.88)\"/><path d=M893.66,158.87c13.48,0,23.2,9.15,23.2,21s-9.72,21-23.2,21-23.2-9.15-23.2-21S880.18,158.87,893.66,158.87Zm0,28.51a7.52,7.52,0,1,0-7.19-7.52A7.18,7.18,0,0,0,893.66,187.38Z transform=\"translate(-4.37 -15.88)\"/><path d=M923.15,159.77H939v3.1l.16.08a19.73,19.73,0,0,1,11.68-4.08,14.91,14.91,0,0,1,10.3,3.84c2.61,2.53,3.92,6.12,3.92,12V200H948.88V177.17a5.35,5.35,0,0,0-1.14-3.84,4.18,4.18,0,0,0-3.1-1.15,8,8,0,0,0-5.31,2.13V200H923.15Z transform=\"translate(-4.37 -15.88)\"/><path d=M347,238.16c0,5.91-1.13,10-3.27,12.84-2.9,3.86-8.22,6.17-14.72,6.17s-12-2.2-14.92-6.33c-2-2.85-3.06-7-3.06-12.68V217.71H322.1v19.81c0,3.76.43,6,1.5,7.46a6.59,6.59,0,0,0,5.64,2.58,6.49,6.49,0,0,0,5.31-2.26c1.24-1.5,1.83-4,1.83-7.78V217.71H347Z transform=\"translate(-4.37 -15.88)\"/><path d=M352.81,217.71H366.4c4.72,0,8.21.59,10.9,1.93a10.6,10.6,0,0,1,6.28,10.15c0,4.78-2.31,8.43-7.14,10.47l10.31,16.32H374.24l-8.65-14.77h-1.72v14.77H352.81Zm13.8,16.53a8.62,8.62,0,0,0,4.35-.8,3.74,3.74,0,0,0-.32-6.28,11.17,11.17,0,0,0-4.72-.65h-2.05v7.73Z transform=\"translate(-4.37 -15.88)\"/><path d=M388.74,217.71H399.8v29.53H416v9.34H388.74Z transform=\"translate(-4.37 -15.88)\"/><path d=M432.39,244a29.83,29.83,0,0,0,13,4c2.25,0,3.86-.81,3.86-2.79,0-2.79-3.11-2.79-8.05-4.51-5.91-2-10-4.94-10-11.23,0-7.57,5.86-12.35,14.55-12.35A30.51,30.51,0,0,1,458.44,220v10.2c-4.68-2.63-9.83-3.86-12.57-3.86-2,0-3.44.64-3.44,2.36,0,2.52,3,2.52,7.74,4.19,6.06,2.15,10.31,5.15,10.31,11.7,0,7.84-6.18,12.62-15.2,12.62a31.71,31.71,0,0,1-12.89-2.79Z transform=\"translate(-4.37 -15.88)\"/><path d=M464.56,215.56h10.63V232.1l.11.05a12.51,12.51,0,0,1,7.41-2.58,9.86,9.86,0,0,1,6.82,2.53c1.72,1.66,2.58,4,2.58,7.89v16.59H481.47v-15a3.49,3.49,0,0,0-.75-2.52,2.73,2.73,0,0,0-2-.76,5.31,5.31,0,0,0-3.49,1.4v16.86H464.56Z transform=\"translate(-4.37 -15.88)\"/><path d=M511.33,229.57c8.86,0,15.25,6,15.25,13.8s-6.39,13.8-15.25,13.8-15.25-6-15.25-13.8S502.47,229.57,511.33,229.57Zm0,18.74a4.95,4.95,0,1,0-4.72-4.94A4.71,4.71,0,0,0,511.33,248.31Z transform=\"translate(-4.37 -15.88)\"/><path d=M530.66,230.16h10.42V233l.11.05a9.26,9.26,0,0,1,7-3.38,10.15,10.15,0,0,1,1.93.21v9.78a13.72,13.72,0,0,0-2.9-.33,8.11,8.11,0,0,0-6,2.21v15H530.66Z transform=\"translate(-4.37 -15.88)\"/><path d=M573.14,255.88a17.14,17.14,0,0,1-6.61,1.29,10.93,10.93,0,0,1-7.78-2.74c-1.51-1.5-2.58-3.76-2.58-8.32v-7.57h-3.92v-8.38h3.92v-6.6l10.63-1.83v8.43h6.34v8.38H566.8v6.82c0,2.09.65,3.27,2.63,3.27a11.56,11.56,0,0,0,3.71-.85Z transform=\"translate(-4.37 -15.88)\"/><path d=M601.81,255.13a26.11,26.11,0,0,1-10.31,2c-9.34,0-15.73-5.15-15.73-13.53,0-8.7,6.82-14.07,14.34-14.07,6.49,0,13.2,4,13.2,13.53a20.81,20.81,0,0,1-.16,2.69H586.56c1,2.79,3.55,3.76,6.39,3.76a19.44,19.44,0,0,0,8.86-2.47Zm-8-14.82a3.62,3.62,0,0,0-3.71-3.22c-1.88,0-3.17,1.18-3.65,3.22Z transform=\"translate(-4.37 -15.88)\"/><path d=M607.77,230.16h10.42v2l.11.06a13,13,0,0,1,7.68-2.69,9.79,9.79,0,0,1,6.76,2.53c1.72,1.66,2.58,4,2.58,7.89v16.59H624.69v-15a3.54,3.54,0,0,0-.75-2.52,2.77,2.77,0,0,0-2.05-.76,5.33,5.33,0,0,0-3.49,1.4v16.86H607.77Z transform=\"translate(-4.37 -15.88)\"/><path d=M665.39,255.13a26.11,26.11,0,0,1-10.31,2c-9.34,0-15.73-5.15-15.73-13.53,0-8.7,6.82-14.07,14.33-14.07,6.5,0,13.21,4,13.21,13.53a20.81,20.81,0,0,1-.16,2.69H650.14c1,2.79,3.54,3.76,6.39,3.76a19.44,19.44,0,0,0,8.86-2.47Zm-8-14.82a3.62,3.62,0,0,0-3.71-3.22c-1.88,0-3.17,1.18-3.65,3.22Z transform=\"translate(-4.37 -15.88)\"/><path d=M671.3,230.16h10.41V233l.11.05a9.28,9.28,0,0,1,7-3.38,10.25,10.25,0,0,1,1.93.21v9.78a13.8,13.8,0,0,0-2.9-.33,8.08,8.08,0,0,0-6,2.21v15H671.3Z transform=\"translate(-4.37 -15.88)\"/></svg></div></div></div><div class=container><div class=row><div class=\"col-12 col-md-6 col-sm-8 offset-md-3 offset-sm-2\"><div class=\"text-center form-row\"><div class=\"col-12 col-sm-4 form-item\"><label>Volume</label> <input class=\"text-center form-control\"id=v placeholder=542 tabindex=1 maxlength=3></div><div class=\"col-12 col-sm-4 form-item\"><label>Page</label> <input class=\"text-center form-control\"id=p placeholder=692 tabindex=2 maxlength=3></div><div class=\"col-12 col-sm-4 form-item\"><label>PDF Page</label> <input class=\"text-center form-control\"id=pp placeholder=1 tabindex=3> <small class=\"form-text text-muted\">Optional</small></div></div></div></div></div><div class=container><div class=row><div class=\"col-12 col-md-6 col-sm-8 offset-md-3 offset-sm-2\"><div class=\"text-center output-group\"><div class=card><div class=card-header>Click to see the PDF!</div><div class=card-body id=b><h4 class=card-title><a href=https://${url}/542/692 target=_blank id=l><div id=t>https://${url}/542/692</div></a></h4><button class=\"btn btn-primary copy\"data-clipboard-target=#t><span>copy link  </span><svg viewBox=\"0 0 24 24\"xmlns=http://www.w3.org/2000/svg height=22 style=position:relative;top:-2px width=22><path d=\"M16 10c3.469 0 2 4 2 4s4-1.594 4 2v6h-10v-12h4zm.827-2h-6.827v16h14v-8.842c0-2.392-4.011-7.158-7.173-7.158zm-8.827 12h-6v-16h4l2.102 2h3.898l2-2h4v2.145c.656.143 1.327.391 2 .754v-4.899h-3c-1.229 0-2.18-1.084-3-2h-8c-.82.916-1.771 2-3 2h-3v20h8v-2zm2-18c.553 0 1 .448 1 1s-.447 1-1 1-1-.448-1-1 .447-1 1-1zm4 18h6v-1h-6v1zm0-2h6v-1h-6v1zm0-2h6v-1h-6v1z\"style=fill:#fff /></svg></button></div></div></div></div></div></div><div class=modal id=about style=overflow:visible><p>Supreme Court opinions are published online in PDF format by the <a href=https://www.supremecourt.gov/opinions/boundvolumes.aspx target=_blank>Supreme Court</a> and the <a href=https://www.loc.gov/collections/united-states-reports/ target=_blank>Library of Congress</a> - but it can be hard to find and link to them.<p>We simplify that - just enter the opinion's Volume and Page, and get a short link directly to the PDF.<p>You can even reference a specific page in the PDF file itself.<p>Feel free to save these links or share them on social media!<p>NOTE: It can take years for PDFs to be made available online. We'll always try to link you to the best available online resource, but if a particular case is not available, <a href=mailto:scotuslink@gmail.com>let us know!</a></div><footer><p><a href=#about rel=modal:open>how does this work?</a><p>by <a href=https://twitter.com/orinkerr target=_blank>@orinkerr</a> and <a href=https://twitter.com/birds_____ target=_blank>@birds_____</a><br>design by <a href=mailto:juan@moncada.io target=_blank>juan@moncada.io</a></footer><script src=https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js></script><script src=https://cdn.jsdelivr.net/jquery.shadow-animation/1/mainfile></script><script src=https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.0/clipboard.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/jquery-modal/0.9.1/jquery.modal.min.js></script><link href=https://cdnjs.cloudflare.com/ajax/libs/jquery-modal/0.9.1/jquery.modal.min.css rel=stylesheet><script>new ClipboardJS(\".copy\"),$(document).ready(function(){$(\"input:first\").focus();var r=!0;$(\"input\").keydown(function(t){(32===t.keyCode||65<=t.keyCode&&t.keyCode<=90)&&t.preventDefault()}),$(\"input\").keyup(function(t){if(String.fromCharCode(t.keyCode).match(/\\d/)){r&&($(\"input\").removeAttr(\"placeholder\"),r=!1);var e=$(\"#v\").val(),a=$(\"#p\").val(),n=$(\"#pp\").val(),o=\"https://${url}/\"+e+\"/\"+a;if(n&&(o+=\"/\"+n),$(\"#t\").html(o),$(\"#l\").attr(\"href\",o),this.value.length==$(this).attr(\"maxlength\")){var i=$(\"input\");i.eq(i.index(this)+1).focus()}$(\"#b\").animate({boxShadow:\"0 0 2px\"},200).animate({boxShadow:\"0 0 0\"},200)}})})</script>"
                        - { url: !FindInMap [URLMap, !Ref EnvironmentParameter, URL] }
                requestTemplates:
                  application/json: "{\"statusCode\": 200}"
                passthroughBehavior: "when_no_match"

          /{volume}/{page}:
            get:
              parameters:
                - name: volume
                  in: path
                  required: true
                  schema:
                    type: string
                - name: page
                  in: path
                  required: true
                  schema:
                    type: string
              responses:
                "200":
                  description: "200 response"
                  headers: {}
                "302":
                  description: "302 response"
                  headers:
                    Location:
                      schema:
                        type: string
              x-amazon-apigateway-integration:
                type: "aws"
                uri: !Join ["/", ["arn:aws:apigateway:us-east-1:lambda:path/2015-03-31/functions", !GetAtt RedirectLambda.Arn, "invocations"]]
                responses:
                  default:
                    statusCode: "302"
                    responseParameters:
                      method.response.header.Location: "integration.response.body.location"
                passthroughBehavior: "when_no_match"
                httpMethod: "POST"
                requestTemplates:
                  application/json: "{\"volume\": \"$input.params('volume')\", \"page\": \"$input.params('page')\"}"
          /{volume}/{page}/{pdfpage}:
            get:
              parameters:
                - name: volume
                  in: path
                  required: true
                  schema:
                    type: string
                - name: page
                  in: path
                  required: true
                  schema:
                    type: string
                - name: pdfpage
                  in: path
                  required: true
                  schema:
                    type: string
              responses:
                "200":
                  description: "200 response"
                  headers: {}
                "302":
                  description: "302 response"
                  headers:
                    Location:
                      schema:
                        type: string
              x-amazon-apigateway-integration:
                type: "aws"
                uri: !Join ["/", ["arn:aws:apigateway:us-east-1:lambda:path/2015-03-31/functions", !GetAtt RedirectLambda.Arn, "invocations"]]
                responses:
                  default:
                    statusCode: "302"
                    responseParameters:
                      method.response.header.Location: "integration.response.body.location"
                passthroughBehavior: "when_no_match"
                httpMethod: "POST"
                requestTemplates:
                  application/json: "{\"volume\": \"$input.params('volume')\", \"page\": \"$input.params('page')\", \"pdfpage\": \"$input.params('pdfpage')\"}"

  RedirectLambdaPermission:
    Type:  AWS::Lambda::Permission
    Properties:
      FunctionName: !GetAtt RedirectLambda.Arn
      Action: lambda:InvokeFunction
      Principal: apigateway.amazonaws.com
      SourceArn: !Sub "arn:aws:execute-api:${AWS::Region}:${AWS::AccountId}:${RedirectAPI}/*"

  RedirectAPIDeployment:
    Type: AWS::ApiGateway::Deployment
    Properties:
      RestApiId: !Ref RedirectAPI
      StageName: api

  # dns
  APIDomainName:
    Type: AWS::ApiGateway::DomainName
    Properties:
      DomainName: !FindInMap [URLMap, !Ref EnvironmentParameter, URL]
      CertificateArn: !Ref CertificateArnParameter

  APIMapping:
    Type: AWS::ApiGateway::BasePathMapping
    Properties:
      DomainName: !FindInMap [URLMap, !Ref EnvironmentParameter, URL]
      RestApiId: !Ref RedirectAPI
      Stage: api

  DNSRecordSet:
    Type: AWS::Route53::RecordSet
    Properties:
      AliasTarget:
        # us-east-1 https://docs.aws.amazon.com/general/latest/gr/rande.html#apigateway_region
        HostedZoneId: Z2FDTNDATAQYW2
        DNSName: !FindInMap [URLMap, !Ref EnvironmentParameter, Edge]
      HostedZoneName: !Ref HostedZoneParameter
      Name: !FindInMap [URLMap, !Ref EnvironmentParameter, URL]
      Type: A

